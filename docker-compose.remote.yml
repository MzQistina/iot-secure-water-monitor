# Remote deployment docker-compose configuration
# Use this when deploying to a different server with remote MySQL access

# To use this file:
# docker-compose -f docker-compose.remote.yml up -d

services:
  # Flask Web Application Service
  # For remote deployment: Connect to external MySQL at ilmuwanutara.my
  web:
    build: .
    container_name: water_monitor_web
    restart: always
    ports:
      - "${FLASK_PORT:-5000}:5000"
    environment:
      # Database connection (external MySQL - requires remote access granted)
      DB_HOST: ${DB_HOST:-ilmuwanutara.my}
      DB_PORT: ${DB_PORT:-3306}
      DB_USER: ${DB_USER:-ilmuwanutara_e2eewater}
      DB_PASSWORD: ${DB_PASSWORD:-e2eeWater@2025}
      DB_NAME: ${DB_NAME:-ilmuwanutara_e2eewater}
      DB_TYPE: mysql
      # Flask configuration
      FLASK_HOST: 0.0.0.0
      FLASK_RUN_PORT: 5000
      PORT: 5000
      FLASK_ENV: ${FLASK_ENV:-production}
      FLASK_DEBUG: ${FLASK_DEBUG:-0}
      PYTHONUNBUFFERED: 1
    volumes:
      # Mount keys directory for persistence
      - ./keys:/app/keys
      - ./user_keys:/app/user_keys
      - ./sensor_keys:/app/sensor_keys

