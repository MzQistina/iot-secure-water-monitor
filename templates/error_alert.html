{# Error Alert Component Macro #}
{% macro error_alert(message, description=None) %}
<div class="error-alert" role="alert">
    <div class="error-alert-content">
        <div class="error-alert-main">
            <svg width="16" height="16" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="error-alert-icon">
                <path d="M10 14.167q.354 0 .593-.24.24-.24.24-.594a.8.8 0 0 0-.24-.593.8.8 0 0 0-.594-.24.8.8 0 0 0-.593.24.8.8 0 0 0-.24.593q0 .354.24.594t.593.24m-.834-3.334h1.667v-5H9.166zm.833 7.5a8.1 8.1 0 0 1-3.25-.656 8.4 8.4 0 0 1-2.645-1.781 8.4 8.4 0 0 1-1.782-2.646A8.1 8.1 0 0 1 1.666 10q0-1.73.656-3.25a8.4 8.4 0 0 1 1.782-2.646 8.4 8.4 0 0 1 2.645-1.781A8.1 8.1 0 0 1 10 1.667q1.73 0 3.25.656a8.4 8.4 0 0 1 2.646 1.781 8.4 8.4 0 0 1 1.781 2.646 8.1 8.1 0 0 1 .657 3.25 8.1 8.1 0 0 1-.657 3.25 8.4 8.4 0 0 1-1.78 2.646 8.4 8.4 0 0 1-2.647 1.781 8.1 8.1 0 0 1-3.25.656" fill="currentColor"/>
            </svg>
            <p class="error-alert-message">{{ message }}</p>
        </div>
        <button type="button" aria-label="close" class="error-alert-close" onclick="this.parentElement.parentElement.remove()">
            <svg width="16" height="16" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M15 5 5 15M5 5l10 10" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
        </button>
    </div>
</div>
{% endmacro %}

{# Error Alert Styles #}
<style>
.error-alert {
    background: rgba(220, 38, 38, 0.2);
    color: #dc2626;
    padding: 0 8px;
    height: 32px;
    border-radius: 6px;
    margin-bottom: 12px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    max-width: 100%;
    width: 100%;
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
}

.error-alert-content {
    display: flex;
    align-items: center;
    justify-content: space-between;
    width: 100%;
    gap: 6px;
}

.error-alert-main {
    display: flex;
    align-items: center;
    flex: 1;
    min-width: 0;
}

.error-alert-icon {
    flex-shrink: 0;
    color: currentColor;
}

.error-alert-message {
    margin: 0;
    font-size: 0.8125rem;
    margin-left: 6px;
    color: #dc2626;
    line-height: 1.3;
}

.error-alert-close {
    background: none;
    border: none;
    cursor: pointer;
    padding: 0;
    margin-left: 8px;
    color: #ef4444;
    transition: color 0.2s, transform 0.1s;
    flex-shrink: 0;
    display: flex;
    align-items: center;
    justify-content: center;
}

.error-alert-close:hover {
    color: #b91c1c;
}

.error-alert-close:active {
    transform: scale(0.9);
}

/* Dark mode support */
[data-theme="dark"] .error-alert {
    background: rgba(220, 38, 38, 0.25);
    color: #fca5a5;
}

[data-theme="dark"] .error-alert-message {
    color: #fca5a5;
}

[data-theme="dark"] .error-alert-close {
    color: #f87171;
}

[data-theme="dark"] .error-alert-close:hover {
    color: #ef4444;
}
</style>

{# JavaScript function to dynamically show error alerts #}
<script>
function showErrorAlert(message, container) {
    // Create the alert element
    var alertDiv = document.createElement('div');
    alertDiv.className = 'error-alert';
    alertDiv.setAttribute('role', 'alert');
    
    alertDiv.innerHTML = `
        <div class="error-alert-content">
            <div class="error-alert-main">
                <svg width="16" height="16" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="error-alert-icon">
                    <path d="M10 14.167q.354 0 .593-.24.24-.24.24-.594a.8.8 0 0 0-.24-.593.8.8 0 0 0-.594-.24.8.8 0 0 0-.593.24.8.8 0 0 0-.24.593q0 .354.24.594t.593.24m-.834-3.334h1.667v-5H9.166zm.833 7.5a8.1 8.1 0 0 1-3.25-.656 8.4 8.4 0 0 1-2.645-1.781 8.4 8.4 0 0 1-1.782-2.646A8.1 8.1 0 0 1 1.666 10q0-1.73.656-3.25a8.4 8.4 0 0 1 1.782-2.646 8.4 8.4 0 0 1 2.645-1.781A8.1 8.1 0 0 1 10 1.667q1.73 0 3.25.656a8.4 8.4 0 0 1 2.646 1.781 8.4 8.4 0 0 1 1.781 2.646 8.1 8.1 0 0 1 .657 3.25 8.1 8.1 0 0 1-.657 3.25 8.4 8.4 0 0 1-1.78 2.646 8.4 8.4 0 0 1-2.647 1.781 8.1 8.1 0 0 1-3.25.656" fill="currentColor"/>
                </svg>
                <p class="error-alert-message">${escapeHtml(message)}</p>
            </div>
            <button type="button" aria-label="close" class="error-alert-close" onclick="this.parentElement.parentElement.remove()">
                <svg width="16" height="16" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M15 5 5 15M5 5l10 10" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </button>
        </div>
    `;
    
    // Find the container to insert the alert
    var targetContainer = container || document.querySelector('.container') || document.body;
    
    // Insert at the beginning of the container
    if (targetContainer.firstChild) {
        targetContainer.insertBefore(alertDiv, targetContainer.firstChild);
    } else {
        targetContainer.appendChild(alertDiv);
    }
    
    // Auto-remove after 7 seconds (errors stay longer than success)
    setTimeout(function() {
        if (alertDiv.parentNode) {
            alertDiv.style.transition = 'opacity 0.3s ease';
            alertDiv.style.opacity = '0';
            setTimeout(function() {
                if (alertDiv.parentNode) {
                    alertDiv.remove();
                }
            }, 300);
        }
    }, 7000);
    
    return alertDiv;
}

// Reuse escapeHtml if not already defined
if (typeof escapeHtml === 'undefined') {
    function escapeHtml(text) {
        var div = document.createElement('div');
        div.textContent = text;
        return div.innerHTML;
    }
}
</script>

